/*https://github.com/vectornet/ajaxtable*/!function(a){a.fn.extend({ajaxTable:function(b){var c={instance_id:"",cols:[],method:"POST",url:"",params:{},params_new:{},page:1,rows:10,rowsJump:3,rowsJumpResponsive:1,rowsOptions:[5,10,20,50,100,500],sortOrder:"ASC",paramToSort:null,responsive:!1,refreshCallbackFunctionBefore:null,refreshCallbackFunctionAfter:null},d={json_response:{}},e={classTable:"ajaxtable-table",classHead:"ajaxtable-head",classBody:"ajaxtable-body",classFoot:"ajaxtable-foot",classLoading:"ajaxtable-loading",classError:"ajaxtable-error",classNoRows:"ajaxtable-norows",classPaginationHead:"ajaxtable-pagination-head",classPaginationFoot:"ajaxtable-pagination-foot",classPaginationContainer:"ajaxtable-pagination-container",classPaginationTotalRows:"ajaxtable-pagination-totalrows",classPaginationPrevious:"ajaxtable-pagination-previous",classPaginationNext:"ajaxtable-pagination-next",classPaginationFirst:"ajaxtable-pagination-first",classPaginationLast:"ajaxtable-pagination-last",classPaginationReload:"ajaxtable-pagination-reload",classPaginationSetRows:"ajaxtable-pagination-setrows",classPaginationJumps:"ajaxtable-pagination-jumps",classPaginationCurrentPage:"ajaxtable-pagination-currentpage",classCols:"ajaxtable-cols",classColSortable:"ajaxtable-col-sortable",classSortAsc:"ajaxtable-sort-asc",classSortDesc:"ajaxtable-sort-desc",classSortArrow:"ajaxtable-sort-arrow"},f={eventPagePrevious:"ajaxtable-event-pageprevious",eventPageNext:"ajaxtable-event-pagenext",eventPageFirst:"ajaxtable-event-pagefirst",eventPageLast:"ajaxtable-event-pagelast",eventPageJumps:"ajaxtable-event-pagejumps",eventSetRows:"ajaxtable-event-pagesetrows",eventReload:"ajaxtable-event-pagereload"},g={textTotalRows:"Display %rowfirst to %rowlast of %rowtotal rows",textPagination:"Pagination",textPrevious:"Previous",textNext:"Next",textFirst:"First",textLast:"Last",textReload:"Reload",textSetRows:"%row rows per page",textNoRows:"No results found",textErrorRetrieveData:"An error occurred during retrieving data, try again",textErrorSetConfig:"The configuration defined for AjaxTable is invalid, try again"};this.each(function(){b instanceof Object?(a(this).data(a.extend(c,d,e,g,b,f)),a(this).data("instance_id",this.id),a(this).buildTableStructure(),a(this).buildTableCols(),a(this).refresh()):(a(this).data(a.extend(c,d,e,g,{cols:[{error:"Error"}]},f)),a(this).data("instance_id",this.id),a(this).buildTableStructure(),a(this).buildTableCols(),a(this).buildErrorReport(a(this).getOption("textErrorSetConfig")))})},buildTableStructure:function(){a(this).addClass(this.getOption("classTable")),this.append('<thead class="'+this.getOption("classHead")+'"></thead>'),this.append('<tbody class="'+this.getOption("classBody")+'"></tbody>'),this.append('<tfoot class="'+this.getOption("classFoot")+'"></tfoot>'),this.find("thead").append('<tr class="'+this.getOption("classPaginationHead")+'"></tr>'),this.find("tfoot").append('<tr class="'+this.getOption("classPaginationFoot")+'"></tr>')},buildTableCols:function(){var a="",b="",c=0;for(c=0;c<this.getOption("cols").length;c++){a+="<th",this.getOption("cols")[c].headerId&&(a+=' id="'+this.getOption("cols")[c].headerId+'"');var d=[];this.getOption("cols")[c].sortable&&d.push(this.getOption("classColSortable")),this.getOption("cols")[c].headerClass&&d.push(this.getOption("cols")[c].headerClass),d.length>0&&(a+=' class="'+d.join(" ")+'"'),a+=">",this.getOption("cols")[c].headerTitle&&(this.getOption("cols")[c].sortable?(a+='<a href="javascript://" onclick="$(\'#'+this.getOption("instance_id")+"').ajaxTableSort('"+this.getOption("cols")[c].valueToSort+"', this);\">"+this.getOption("cols")[c].headerTitle+"</a>",a+='<span class="'+this.getOption("classSortArrow")+'">',this.getOption("sortCol")&&this.getOption("sortCol")==this.getOption("cols")[c].valueToSort&&(a+="ASC"===this.getOption("sortOrder")?"▲":"▼"),a+="<span>"):a+=this.getOption("cols")[c].headerTitle),a+="</th>",b+="<colgroup",this.getOption("cols")[c].colgroupClass&&(b+=' class="'+this.getOption("cols")[c].colgroupClass+'"'),this.getOption("cols")[c].colgroupid&&(b+=' id="'+this.getOption("cols")[c].colgroupid+'"'),b+=" ></colgroup>"}this.prepend(b),this.find("thead").append('<tr class="'+this.getOption("classCols")+'">'+a+"</tr>")},refresh:function(){if("function"==typeof this.getOption("refreshCallbackFunctionBefore"))this.getOption("refreshCallbackFunctionBefore")();else if(this.getOption("refreshCallbackFunctionBefore")){var a=this.getOption("refreshCallbackFunctionBefore");window[a]()}if(this.loadAjaxData(),this.bindEventElements(),"function"==typeof this.getOption("refreshCallbackFunctionAfter"))this.getOption("refreshCallbackFunctionAfter")();else if(this.getOption("refreshCallbackFunctionAfter")){var a=this.getOption("refreshCallbackFunctionAfter");window[a]()}},setOption:function(a,b){this.data(a,b)},getOption:function(a){return this.data(a)},setRequestParam:function(a,b){this.data("params_new")[a]=b,this.setOption("page",1)},getRequestParam:function(a){return this.data("params_new")[a]},getDefaultRequestParam:function(a){return this.data("params")[a]},clearRequestParams:function(){this.setOption("params_new",{}),this.setOption("page",1)},getAjaxTableRequestParams:function(){if(this.getOption("responsive")){var a=[],b=0;for(b=0;b<this.getOption("cols").length;b++)a.push(this.getOption("cols")[b].headerTitle);a=JSON.stringify(a)}else var a=this.getOption("cols").length;return{"ajaxTableOptions[responsive]":this.getOption("responsive"),"ajaxTableOptions[cols]":a,"ajaxTableOptions[rows]":this.getOption("rows"),"ajaxTableOptions[page]":this.getOption("page"),"ajaxTableOptions[sortOrder]":this.getOption("sortOrder"),"ajaxTableOptions[sortCol]":null==this.getOption("sortCol")?"":this.getOption("sortCol")}},loadAjaxData:function(){this.removeClass(this.getOption("classError")),this.addClass(this.getOption("classLoading"));var b=a.extend(!1,this.getAjaxTableRequestParams(),this.getOption("params_new"),this.getOption("params"));a.ajax({context:this,url:this.getOption("url"),data:b,type:this.getOption("method"),instance_id:this.getOption("instance_id"),async:!1,dataType:"json",error:function(a,b,c){this.buildErrorReport(this.getOption("textErrorRetrieveData"))},success:function(b,c,d){this.setOption("json_response",b),this.clearBody(),this.setOption("page",b.page),this.getOption("json_response").totalRecords>10&&this.getOption("rows")>10?a("#"+this.attr("id")+" ."+this.getOption("classPaginationHead")).html(this.getPagination()):a("#"+this.attr("id")+" ."+this.getOption("classPaginationHead")).html(""),a("#"+this.attr("id")+" ."+this.getOption("classPaginationFoot")).html(this.getPagination()),this.getOption("json_response").totalRecords>0?this.find("tbody").html(this.getOption("json_response").html):this.find("tbody").html(this.getNoRows()),this.removeClass(this.getOption("classLoading"))}})},buildErrorReport:function(b){this.setOption("json_response",{totalPages:1,page:1,totalRecords:0,html:""}),this.clearBody(),this.setOption("page",1),a("."+this.getOption("classPaginationFoot")).html(this.getPagination()),this.find("tbody").html(this.getError(b)),this.removeClass(this.getOption("classLoading")),this.addClass(this.getOption("classError"))},getNoRows:function(){return'<tr class="'+this.getOption("classNoRows")+'"><td colspan="'+this.getOption("cols").length+'">'+this.getOption("textNoRows")+"</td></tr>"},getError:function(a){return'<tr class="'+this.getOption("classError")+'"><td colspan="'+this.getOption("cols").length+'">'+a+"</td></tr>"},jumpToPage:function(b){b<=this.getOption("json_response").totalPages&&(this.setOption("page",b),a(this).refresh())},ajaxTableSort:function(b,c){this.getOption("sortCol")===b?this.setOption("sortOrder","DESC"===this.getOption("sortOrder")?"ASC":"DESC"):this.setOption("sortOrder","ASC"),this.setOption("sortCol",b),a("."+this.getOption("classSortArrow")).html(""),a("."+this.getOption("classSortAsc")).removeClass(this.getOption("classSortAsc")),a("."+this.getOption("classSortDesc")).removeClass(this.getOption("classSortDesc")),a(c).parent().addClass(this.getOption("ASC"===this.getOption("sortOrder")?"classSortAsc":"classSortDesc")).find("span").html("ASC"===this.getOption("sortOrder")?"▲":"▼"),a(this).refresh()},clearBody:function(){this.find("tbody").length&&this.find("tbody").html("")},getPagination:function(){var a='<td colspan="'+this.getOption("cols").length+'">';if(a+='<div class="'+this.getOption("classPaginationContainer")+'"><ul>',this.getOption("page")>1){var b="<li "+(this.getOption("classPaginationFirst")?'class="'+this.getOption("classPaginationFirst")+'"':"")+">";b+='<a href="javascript://" onclick="$(\'#'+this.attr("id")+"').goToFirst();\">"+this.getOption("textFirst")+"</a>",b+="</li>";var c="<li "+(this.getOption("classPaginationPrevious")?'class="'+this.getOption("classPaginationPrevious")+'"':"")+">";c+='<a href="javascript://" onclick="$(\'#'+this.attr("id")+"').goToPrevious();\">"+this.getOption("textPrevious")+"</a>",c+="</li>",a+=b+c}for(var d="",e=this.getOption("responsive")&&screen.width<=480?this.getOption("rowsJumpResponsive"):this.getOption("rowsJump"),f=-e;f<=e;f++)parseInt(this.getOption("page"))+f<=this.getOption("json_response").totalPages&&parseInt(this.getOption("page"))+f>0&&(d+=0==f?"<li"+(this.getOption("classPaginationCurrentPage")?' class="'+this.getOption("classPaginationCurrentPage")+'"':"")+"><a>"+parseInt(this.getOption("page"))+"</a></li>":"<li"+(this.getOption("classPaginationJumps")?' class="'+this.getOption("classPaginationJumps")+'"':"")+'><a href="javascript://" onclick="$(\'#'+this.attr("id")+"').jumpToPage("+(parseInt(this.getOption("page"))+f)+');">'+(parseInt(this.getOption("page"))+f)+"</a></li>");if(a+=d,this.getOption("page")<this.getOption("json_response").totalPages){var g="<li "+(this.getOption("classPaginationNext")?'class="'+this.getOption("classPaginationNext")+'"':"")+">";g+='<a href="javascript://" onclick="$(\'#'+this.attr("id")+"').goToNext();\">"+this.getOption("textNext")+"</a>",g+="</li>";var h="<li "+(this.getOption("classPaginationLast")?'class="'+this.getOption("classPaginationLast")+'"':"")+">";h+='<a href="javascript://" onclick="$(\'#'+this.attr("id")+"').goToLast();\">"+this.getOption("textLast")+"</a>",h+="</li>",a+=g+h}var i="<li "+(this.getOption("classPaginationReload")?'class="'+this.getOption("classPaginationReload")+'"':"")+">";i+='<a href="javascript://" onclick="$(\'#'+this.attr("id")+"').refresh();\">"+this.getOption("textReload")+"</a>",i+="</li>",a+=i,a+="</ul></div>",a+='<div class="'+this.getOption("classPaginationSetRows")+'">',a+="<select onchange=\"$('#"+this.attr("id")+"').changeRowsPerPage(this.value);\">";for(var f=0;f<this.getOption("rowsOptions").length;f++)a+='<option value="'+this.getOption("rowsOptions")[f]+'"',a+=this.getOption("rows")==this.getOption("rowsOptions")[f]?' selected="selected"':"",a+=">",a+=this.getOption("textSetRows").replace("%row",this.getOption("rowsOptions")[f])+"</option>";if(a+="</select></div>",this.getOption("json_response").totalRecords>0){var j=this.getOption("textTotalRows");j=j.replace("%rowfirst",this.getOption("rows")*this.getOption("page")+1-this.getOption("rows")),j=this.getOption("page")*this.getOption("rows")>this.getOption("json_response").totalRecords?j.replace("%rowlast",this.getOption("json_response").totalRecords):j.replace("%rowlast",this.getOption("page")*this.getOption("rows")),j=j.replace("%rowtotal",this.getOption("json_response").totalRecords)}else var j=this.getOption("textNoRows");return a+='<div class="'+this.getOption("classPaginationTotalRows")+'">'+j+"</div>",a+="</td>"},changeRowsPerPage:function(a){this.setOption("rows",a),this.refresh()},goToPrevious:function(){this.setOption("page",this.getOption("page")>1?this.getOption("page")-1:1),this.refresh()},goToNext:function(){this.setOption("page",this.getOption("page")<this.getOption("json_response").totalPages?this.getOption("page")+1:this.getOption("json_response").totalPages),this.refresh()},goToFirst:function(){this.setOption("page",1),this.refresh()},goToLast:function(){this.setOption("page",this.getOption("json_response").totalPages),this.refresh()},bindEventElements:function(){}})}(jQuery);